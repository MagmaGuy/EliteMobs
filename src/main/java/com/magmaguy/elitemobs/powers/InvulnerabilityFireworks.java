package com.magmaguy.elitemobs.powers;

import com.magmaguy.elitemobs.config.powers.PowersConfig;
import com.magmaguy.elitemobs.entitytracker.EntityTracker;
import com.magmaguy.elitemobs.mobconstructor.EliteEntity;
import com.magmaguy.elitemobs.powers.meta.MinorPower;
import org.bukkit.entity.Firework;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.entity.EntityDamageByEntityEvent;

public class InvulnerabilityFireworks extends MinorPower implements Listener {
    public InvulnerabilityFireworks() {
        super(PowersConfig.getPower("invulnerability_fireworks.yml"));
    }

    @EventHandler(ignoreCancelled = true)
    public void onEliteDamaged(EntityDamageByEntityEvent event) {
        if (!(event.getDamager() instanceof Firework)) return;
        EliteEntity eliteEntity = EntityTracker.getEliteMobEntity(event.getEntity());
        if (eliteEntity == null) return;
        if (!eliteEntity.hasPower(this)) return;
        event.setCancelled(true);
    }
}
